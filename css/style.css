@import url("https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Fascinate+Inline&display=swap");

/* ---- Sudowrite-style gradient background ---- */
:root{
  /* tweak these if you want it warmer/cooler */
  --sw-lavender: #b8a6ff;   /* soft purple */
  --sw-cyan:     #7cf7e3;   /* minty cyan */
  --sw-pink:     #ff9ae6;   /* candy pink */
  --sw-white:    #ffffff;   /* blend base */
}

/* Full-page gradient */
html, body { height: 100%; }

body{
  /* fallback color */
  background-color: var(--sw-white);

  /* multi-stop linear gradient */
  background-image:
    linear-gradient(
      135deg,
      var(--sw-lavender) 0%,
      #c7b6ff 18%,
      var(--sw-cyan) 48%,
      #9eeadf 62%,
      var(--sw-pink) 85%,
      #ffd1f4 100%
    );

  /* make it feel soft & roomy */
  background-attachment: fixed;
  background-repeat: no-repeat;
  background-size: cover;
}

/* — Flip Pages Notebook (scoped for Twine) — */
@import url("https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap");

/* Don’t touch the whole page — scope everything to .flipbook */
.flipbook,
.flipbook * {
  box-sizing: border-box;
}

/* A local “stage” so we’re not styling <body> */
.flipbook {
  font-family: "Indie Flower", cursive;
  color: #555;
  display: block;
  /* keep the widget centered within Twine’s passage width */
  margin: 2rem auto;
  text-align: center;
  /* optional background just around the widget, not the whole story */
  background: #eee;
  padding: 2rem 0;
  border-radius: 6px;
}

/* If your passage width is constraining things, allow it to overflow neatly */
tw-passage { overflow: visible; }

/* Center a fixed-size stage that matches the Pen’s intent */
.flipbook .stage {
  width: 420px;           /* matches the Pen */
  height: 420px;          /* matches the Pen */
  position: relative;
  border: #fff solid 2px;
  border-radius: 4px;
  margin: 0 auto;
}

/* -------- Pen styles, with selectors rewritten under .flipbook -------- */
.flipbook .imgLoader {
  position: fixed;
  animation: preLoad 1s steps(1);
  width: 1px; height: 1px;
}

@keyframes preLoad {
  0%   { background-image: url("https://picsum.photos/420/300?random=1"); }
  10%  { background-image: url("https://picsum.photos/420/300?random=2"); }
  20%  { background-image: url("https://picsum.photos/420/300?random=3"); }
  30%  { background-image: url("https://picsum.photos/420/300?random=4"); }
  40%  { background-image: url("https://picsum.photos/420/300?random=5"); }
  100% { display: none; }
}

.flipbook .title {
  position: absolute;
  top: 45px; left: 0; width: 100%;
  font-size: 2em; font-weight: normal; line-height: 1;
}

.flipbook .credit {
  position: absolute;
  top: 100%; left: 0;
  font-size: 0.9em; text-align: left;
}

.flipbook .book {
  position: relative;
  perspective: 630px;
  perspective-origin: center 50px;
  /* remove the scale that can look odd in Twine; re-enable if you want */
  /* transform: scale(1.2); */
  filter: drop-shadow(0px 10px 5px rgba(0,0,0,.25));
  margin: 0 auto;
}

.flipbook .page {
  width: 210px; height: 300px;
  background-color: #bbb;
  position: absolute; top: 0px; right: 50%;
  transform-origin: 100% 100%;
  border: solid #555 2px;
  background-size: 420px 300px;
  background-position: center;
  transform-style: preserve-3d;
}

.flipbook .pages,
.flipbook .flips { transform-style: preserve-3d; }

.flipbook .page:nth-child(1) { transform: rotateX(60deg) rotateY(3deg); }
.flipbook .page:nth-child(2) { transform: rotateX(60deg) rotateY(4.5deg); }
.flipbook .page:nth-child(3) {
  transform: rotateX(60deg) rotateY(6deg);
  animation: nextPage 25s infinite -24s steps(1);
  background-size: 420px 300px;
  background-position: -2px -2px;
}
.flipbook .page:nth-child(4) { transform: rotateX(60deg) rotateY(177deg); }
.flipbook .page:nth-child(5) { transform: rotateX(60deg) rotateY(175.5deg); }
.flipbook .page:nth-child(6) {
  transform: rotateX(60deg) rotateY(174deg);
  overflow: hidden;
}
.flipbook .page:nth-child(6)::after {
  content: "";
  width: 210px; height: 300px;
  position: absolute; top: 0px; right: 0%;
  transform-origin: center; transform: rotateY(180deg);
  animation: nextPage 25s -20s infinite steps(1);
  background-size: 420px 300px; background-position: 100% -2px;
}

@keyframes nextPage {
  0%  { background-image: url("https://picsum.photos/420/300?random=1"); }
  20% { background-image: url("https://picsum.photos/420/300?random=2"); }
  40% { background-image: url("https://picsum.photos/420/300?random=3"); }
  60% { background-image: url("https://picsum.photos/420/300?random=4"); }
  80% { background-image: url("https://picsum.photos/420/300?random=5"); }
}

.flipbook .gap {
  width: 10px; height: 300px; background: none;
  transform: rotateX(60deg); transform-origin: bottom;
  position: absolute; top: 0px; left: calc(50% - 5px);
}
.flipbook .gap::after {
  content: ""; position: absolute; bottom: 0; left: 50%;
  transform: translate(-50%, 50%); background-color: #555;
  width: 10px; height: 5px; border-radius: 50%;
}

.flipbook .flip {
  width: 32px; height: 300px; position: absolute; top: 0px;
  transform-origin: 100% 100%;
  right: 100%; border: solid #555; border-width: 2px 0px;
  perspective: 4200px; perspective-origin: center;
  transform-style: preserve-3d; background-size: 420px 300px;
}
.flipbook .flip::after {
  content: ""; position: absolute; top: 0px; right: 0%;
  width: 100%; height: 100%; transform-origin: center;
  background-size: 420px 300px;
}

/* …keep the rest of the flipX / nextFlipX keyframes exactly as in the Pen… */
.flipbook .flip.flip1 { right: 50%; animation: flip1 5s infinite ease-in-out; border-width: 2px 2px 2px 0; }
.flipbook .flip:not(.flip1) { right: calc(100% - 2px); top: -2px; transform-origin: right; animation: flip2 5s ease-in-out infinite; }
.flipbook .flip.flip7 { width: 30px; border-width: 2px 0px 2px 2px; }

@keyframes flip1 { 0%,20% { transform: rotateX(60deg) rotateY(6deg) } 80%,100% { transform: rotateX(60deg) rotateY(174deg) } }
@keyframes flip2 { 0%,20% { transform: rotateY(0deg) translateY(0) } 50% { transform: rotateY(-15deg) translateY(0) } }

/* NextFlip1..NextFlip7 copied 1:1 from the Pen, but keep them as-is */
@keyframes nextFlip1 { /* …snipped for brevity — copy from the Pen… */ }
@keyframes nextFlip2 { /* … */ }
@keyframes nextFlip3 { /* … */ }
@keyframes nextFlip4 { /* … */ }
@keyframes nextFlip5 { /* … */ }
@keyframes nextFlip6 { /* … */ }
@keyframes nextFlip7 { /* … */ }

/* 1) Center the book inside the stage */
.flipbook .stage {
  width: 420px;
  height: 420px;
  position: relative;
  display: grid;
  place-items: center;   /* centers .book perfectly */
  margin: 0 auto;
}

/* 2) Keep .book from inheriting odd spacing; scale if you like */
.flipbook .book {
  position: relative;
  margin: 0;             /* don’t rely on global centering */
  transform: scale(1.2); /* optional; remove if you want 1:1 size */
  perspective: 630px;
  perspective-origin: center 50px;
  filter: drop-shadow(0px 10px 5px rgba(0,0,0,.25));
}

/* 3) Ensure proper 3D stacking + crisp faces */
.flipbook .pages,
.flipbook .flips {
  transform-style: preserve-3d;
}

.flipbook .page,
.flipbook .flip,
.flipbook .flip::after {
  backface-visibility: hidden;
  transform-style: preserve-3d;
}

/* 4) If the whole widget still tilts oddly, neutralize any inherited transforms */
tw-story, tw-passage {
  transform: none !important;
}
